---
title: Integration Workshop
layout: presentation
---

# Mistral Assembly 2018

### Integration Workshop

Will Usher, Tom Russell &amp; Roald Lemmen

---

# Agenda

Day 2: Morning (09:30 - 10:30)

1. Overview and challenges (Will)
1. The Software Model Integration Framework (Roald)
1. Plenary discussion

---

# What is Smif

* Smif - Software Model Integration Framework 
  + Connect System Models
  + Configure a System-of-System Model
  + Execute System-of-System Model Runs

<center>  
  <img src="../fig/integration-workshop/smif-overview.png" alt="Smif Overview" align="middle" style="width: 400px;"/>
</center>

???

Smif is the Software Model Integration Framework.
It is the framework that we have developed in the Mistral program to handle the creation of system-of-systems models,
this facilitates the itegration process and helps us to build Nismod2.

Smif is a framework that acts as the integration layer between system models (see illustration). 
It connect model inputs and outputs, takes care of dependencies and provides data to models in the correct spatial-temporal resolution.

Today I will be demonstrating the user-interfaces that we have developed to help our users  
setup and run a system-of-systems model.

---

# Build a System-of-System model

Smif App

<video width="800" height="400" controls>
  <source src="../fig/integration-workshop/smif-app.webm" type="video/webm" >
Your browser does not support the video tag.
</video> 

???

Smif app is the user interface that helps to setup a system-of-systems model.

In the following video, I will demonstrate the process of creating a basic energy-demand/supply system-of-systems model, that is driven by population scenarios.

The video will be fairly quick, my goal is not to get into details, but I just want you to get an impression of the workflow that we have in place for system modellers.

>> Smif app can be opened from the command-line interface, this command opens the smif welcome screen

>> The project configuration that I have prepared contains two simulation models (energy-supply and energy-demand model) and a scenario set for population

>> Lets have a look at the population scenario set. The population set contains a facet for a population, which can be sourced by three different population data set (low, medium and high)

>> Lets have a look at the energy supply model
>> The model contain a path to a wrapper file that implements the interface to this model
>> There are inputs and outputs defined, each with a temporal and spatial resolution
>> A similar setup can be found for the energy-demand model

>> The next step now is to create a system-of-systems model
>> A system-of-systems defines the dependencies between scenarios and simulation models
>> In this example We are going to couple the population scenario, to the energy-demand model
>> and the energy-demand model to the energy-supply model

>> Now that we have a system-of-system model configuration, we can setup a Model Run configuration
>> A model run brings together a system-of-systems model definition with timesteps and a choice of scenarios

---

# Execute Model Runs

Smif Run

<br>
<center>
  <img class="gifplayer" src="../fig/integration-workshop/smif-run-preview.png" data-gif="../fig/integration-workshop/smif-run.gif" width="700px" height="auto"/>
</center>

???

Smif run is a command line interface that helps to run a system-of-systems model

>> **smif** Shows all of the available commands

>> **smif list** Shows all of the available model Runs, like the one I just demonstrated

>> **smif run** Starts a modelrun and shows when this is demonstrate

>> **smif -v run** Prints debug information to the command line interface and gives you a more detailed report of what the modelrun system is doing

---

# Execute Model Runs

Smif Results

<br>
<br>
<center>
    <img src="../fig/integration-workshop/smif-results.png" alt="Smif Results" width="700px" height="auto"/>
</center>  

???

After a succesful modelrun, modelrun results will be written to the filesystem. Nicely ordered by modelname, output, timestep and temporal/spatial resolution
In the future this will be replaced by a datastore.

---

# Some last notes

* Smif is a generic framework

???

Smif offers a generic concept for coupling models, it is not Mistral specific and can be used to couple any-type of models.

--

* Smif is open-source (MIT-license)
* Current version v0.7.6
* https://github.com/nismod/smif

???

Smif is open source, the current version is v0.7.6 is available on Github.

--

* Available on PyPi `pip install smif`
* Sample project available!

???

Smif is available on the Python package index and there are sample projects to get started. 

---

# Further steps

* Consult with Sector Modellers

* Ideas
  + Modelrun user-interface (now only CLI)
  + Data visualisation
  + Tools to support integration debugging

???

Further steps

At this moment we are pretty happy with the features. And we are starting to integrate more models into Nismod2 using Smif.

>> We will consult with Sector Modellers to find out how can best be support this group, as we will be doing in the discussion after this presentation

>> Some of the ideas we have are:

---

# Discussion

## Reproducible data pre-processing pipelines

---

# Discussion

## NISMOD2 releases

???

A challenge of developing a highly integrated model like Nismod2, 
is that at some point the model will be used for research, while others members of the consortium still want to make changes to the model.
To enable doing research and writing models at the same time, it is necessary to release the model regularly.

>> One of the questions that we are currently asking is, how often should we release new version of Nismod?

--

- How frequently does the Nismod2 need to be released?

--

<center>
  <img src="../fig/integration-workshop/discussion-deployment.png" alt="Discussion Deployment" width="400px" height="auto"/>
</center>

???

[show release cycle]

We have started to formalise the following release schedule which defines a process to release a version of Nismod2 every 4-weeks
* In the development phase modellers may make changes to the model, this phase ends with a Pre-release of Nismod2
* This pre-release version is then tested for a week and then a final release of Nismod2 is deployed
* This process repeats every 4-weeks

>> We would like to discuss here, how can we best tweak, clarify or support this process?

--

- How can we best tweak, clarify or support the release process?

---

# Discussion

## Internal collaborations - what does smif need to do to enable the collaborations

---

## Thanks!

Questions?

[https://nismod.github.io/presentations/integration-workshop.html](https://nismod.github.io/presentations/integration-workshop.html)

will.usher@ouce.ox.ac.uk

tom.russell@ouce.ox.ac.uk

roald.lemmen@ouce.ox.ac.uk